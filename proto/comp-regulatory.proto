/*
Â© 2025 Sharon Aicler (saichler@gmail.com)

Layer 8 Ecosystem is licensed under the Apache License, Version 2.0.
You may obtain a copy of the License at:

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
*/

syntax = "proto3";

package comp;

option go_package = "./types/comp";

import "comp-common.proto";
import "erp-common.proto";
import "api.proto";

// =====================
// REGULATION
// =====================

// @PrimeObject
// CompRegulation represents a regulatory framework or standard
message CompRegulation {
    string regulation_id = 1;
    string code = 2;
    string name = 3;
    string description = 4;
    CompRegulationType regulation_type = 5;
    string jurisdiction = 6;
    string issuing_body = 7;
    int64 effective_date = 8;
    int64 sunset_date = 9;
    string version = 10;
    string source_url = 11;
    bool is_active = 12;
    repeated string applicable_industries = 13;
    repeated string applicable_regions = 14;
    string owner_id = 15;                      // cross-ref: Employee
    map<string, string> custom_fields = 16;
    erp.AuditInfo audit_info = 17;
    repeated CompRequirement requirements = 18;
}

message CompRegulationList {
    repeated CompRegulation list = 1;
    l8api.L8MetaData metadata = 2;
}

// =====================
// REQUIREMENT
// =====================

// CompRequirement represents a specific compliance requirement within a regulation
message CompRequirement {
    string requirement_id = 1;
    string parent_requirement_id = 3;          // cross-ref: CompRequirement (for hierarchy)
    string code = 4;
    string title = 5;
    string description = 6;
    string guidance = 7;
    CompSeverityLevel priority = 8;
    bool is_mandatory = 9;
    int32 review_frequency_days = 10;
    string control_objective = 11;
    repeated string evidence_requirements = 12;
    string owner_id = 13;                      // cross-ref: Employee
    bool is_active = 14;
    map<string, string> custom_fields = 15;
    erp.AuditInfo audit_info = 16;
    repeated CompViolationRecord violations = 17;
    repeated CompComplianceStatus statuses = 18;
}

// =====================
// COMPLIANCE STATUS
// =====================

// CompComplianceStatus tracks compliance status for an entity against a requirement
message CompComplianceStatus {
    string status_id = 1;
    string entity_type = 3;                    // e.g., "Department", "Process", "System"
    string entity_id = 4;
    CompComplianceStatusType status = 5;
    int64 assessment_date = 6;
    int64 next_review_date = 7;
    string assessor_id = 8;                    // cross-ref: Employee
    string evidence_document_id = 9;           // cross-ref: DocDocument
    string notes = 10;
    double compliance_score = 11;
    repeated string gap_descriptions = 12;
    map<string, string> custom_fields = 13;
    erp.AuditInfo audit_info = 14;
}

// =====================
// CERTIFICATION
// =====================

// @PrimeObject
// CompCertification represents an organizational certification or accreditation
message CompCertification {
    string certification_id = 1;
    string name = 2;
    string description = 3;
    string issuing_body = 4;
    string certificate_number = 5;
    CompCertificationStatus status = 6;
    int64 issue_date = 7;
    int64 expiry_date = 8;
    string scope = 9;
    repeated string covered_locations = 10;
    repeated string covered_processes = 11;
    string regulation_id = 12;                 // cross-ref: CompRegulation
    string certificate_document_id = 13;       // cross-ref: DocDocument
    string responsible_id = 14;                // cross-ref: Employee
    erp.Money certification_cost = 15;
    int32 renewal_lead_days = 16;
    map<string, string> custom_fields = 17;
    erp.AuditInfo audit_info = 18;
}

message CompCertificationList {
    repeated CompCertification list = 1;
    l8api.L8MetaData metadata = 2;
}

// =====================
// VIOLATION RECORD
// =====================

// CompViolationRecord documents a compliance violation or non-conformance
message CompViolationRecord {
    string violation_id = 1;
    string violation_number = 3;
    string title = 4;
    string description = 5;
    CompSeverityLevel severity = 6;
    CompFindingStatus status = 7;
    int64 discovery_date = 8;
    string discovered_by_id = 9;               // cross-ref: Employee
    string assigned_to_id = 10;                // cross-ref: Employee
    string entity_type = 11;
    string entity_id = 12;
    string root_cause = 13;
    string corrective_action = 14;
    int64 due_date = 15;
    int64 closed_date = 16;
    erp.Money potential_penalty = 17;
    erp.Money actual_penalty = 18;
    string evidence_document_id = 19;          // cross-ref: DocDocument
    map<string, string> custom_fields = 20;
    erp.AuditInfo audit_info = 21;
}

